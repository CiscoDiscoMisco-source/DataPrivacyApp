# Data Privacy Management App

A web application for users to manage their data privacy preferences across companies, visualize data-sharing relationships, and clone preferences efficiently.

## Features

- Display a map/list of companies with data-sharing details
- Manage data preferences locally (per company) and globally (across all companies)
- Clone preferences from one company to another
- Search functionality for companies and preferences

## Technical Stack

- Backend: Python (Flask)
- Frontend: React.js
- Database: PostgreSQL
- Search: Elasticsearch (elastic.co hosting)
- Testing: pytest

## Project Structure

```
data-privacy-app/
├── backend/           # Flask backend application
├── frontend/         # React frontend application
├── tests/           # Test files
├── docs/            # Documentation
└── README.md        # This file
```

## Setup Instructions

### Prerequisites

- Python 3.11+
- Node.js 18+
- PostgreSQL
- Elasticsearch (elastic.co hosting)

### Backend Setup

1. Create and activate virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

2. Install dependencies:
   ```bash
   cd backend
   pip install -r requirements.txt
   ```

3. Set up environment variables:
   ```bash
   cp .env.example .env
   # Edit .env with your configuration
   ```

4. Initialize database:
   ```bash
   flask db upgrade
   ```

### Frontend Setup

1. Install dependencies:
   ```bash
   cd frontend
   npm install
   ```

2. Set up environment variables:
   ```bash
   cp .env.example .env
   # Edit .env with your configuration
   ```

3. Start development server:
   ```bash
   npm start
   ```

## Development

- Backend runs on http://localhost:5000
- Frontend runs on http://localhost:3000
- API documentation available at http://localhost:5000/api/docs

## Testing

Run tests with:
```bash
pytest
```

## License

MIT License

## Amplify Deployment & Configuration

### amplify_outputs.json Generation

The `amplify_outputs.json` file contains configuration details that connect your frontend to AWS Amplify backend resources. This file is required for the application to run properly but is not committed to the repository for security reasons.

#### Automatic Generation

This file is automatically generated:

1. **During local development**: When you run `npx ampx sandbox`
2. **Pre-build hook**: Before building the application (using the `prebuild` npm script)
3. **CI/CD pipeline**: As part of the GitHub workflow

#### Manual Generation

If you need to generate this file manually:

```bash
# Option 1: Using npm script
npm run generate-outputs

# Option 2: Using script directly
node scripts/generate-amplify-outputs.js --appId YOUR_APP_ID --envName YOUR_ENV_NAME
```

#### Setting up CI/CD

To set up CI/CD with GitHub Actions, ensure the following secrets are configured in your repository:

- `AWS_ACCESS_KEY_ID`: AWS access key with Amplify permissions
- `AWS_SECRET_ACCESS_KEY`: AWS secret key
- `AWS_REGION`: The AWS region of your Amplify app (e.g., us-east-1)
- `AMPLIFY_APP_ID`: Your Amplify application ID
- `AMPLIFY_ENV_NAME`: Your Amplify environment name (e.g., dev, prod)

These secrets are used by the `.github/workflows/amplify-deploy.yml` workflow to authenticate with AWS and generate the `amplify_outputs.json` file during the build process. 